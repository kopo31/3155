#include <stdio.h>
#include <stdio.h>
#include <time.h>

int getDays(int year, int month) {
    if (month == 2) {
        if ((year % 4 == 0 && year % 100 != 0) || (year % 400 == 0))
            return 29;
        else
            return 28;
    }

    int days[12] = {31,28,31,30,31,30,31,31,30,31,30,31};
    return days[month - 1];
}

int getStartWeekday(int year, int month) {
    struct tm date = {0};
    date.tm_year = year - 1900;
    date.tm_mon = month - 1;
    date.tm_mday = 1;
    mktime(&date);
    return date.tm_wday; 
}

void printDday(int year, int month) {
    time_t now = time(NULL);
    struct tm target = {0};
    target.tm_year = year - 1900;
    target.tm_mon = month - 1;
    target.tm_mday = 1;

    double diff = difftime(mktime(&target), now) / (60 * 60 * 24);
    printf("\nd-day: %.0f\n", diff);
}

void printCalendar(int year, int month) {
    int start = getStartWeekday(year, month);
    int days = getDays(year, month);

    printf("\n%d%02d\n", year, month);
    printf(" s  m  t  w  t  f  s\n");

    for (int i = 0; i < start; i++) printf("   ");

    for (int d = 1; d <= days; d++) {
        printf("%2d ", d);
        if ((start + d) % 7 == 0) printf("\n");
    }
    printf("\n");
}

int main() {
    int y, m;
    printf("연도 입력: ");
    scanf("%d", &y);
    printf("월 입력: ");
    scanf("%d", &m);

    printCalendar(y, m);
    printDday(y, m);
    return 0;
}
